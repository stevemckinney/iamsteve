---
name: contentlayer
description: Contentlayer2 patterns for MDX content, frontmatter schema, file naming, and content queries
keywords: [contentlayer, blog, post, content, mdx, markdown, frontmatter, metadata, article]
patterns:
  - Creating blog posts
  - Writing MDX content
  - Managing frontmatter
  - Organizing content files
---

# Contentlayer Skill

This skill defines patterns for working with Contentlayer2, our content management system for MDX blog posts, pages, and collections.

## When to Use This Skill

Activate this skill when:
- Creating new blog posts
- Editing existing content
- Managing frontmatter metadata
- Organizing content files
- Working with MDX components
- Querying content data

## Document Types

### Post (Blog Posts)

File location: `content/blog/**/*.md`
File naming: `content/blog/YYYY-slug-here.md` (year prefix required)

#### Complete Frontmatter Template

```yaml
---
title: Your Post Title Here
summary: Brief summary shown in post listings (1-2 sentences)
metadesc: SEO meta description (up to 160 characters)
date: 2026-01-15
lastmod: 2026-01-15
id: 1234
status: draft
categories:
  - Design
tags:
  - css
  - responsive-design
  - container-queries
theme: indigo
fileroot: container-queries
medium: /images/blog/container-queries-medium.png
large: /images/blog/container-queries-large.png
ogImage: /images/blog/container-queries-og.png
images:
  - /images/blog/container-queries-example-1.png
  - /images/blog/container-queries-example-2.png
codepen: false
twitter: false
---

Your MDX content here...
```

#### Field Reference

| Field | Type | Required | Description | Example |
|-------|------|----------|-------------|---------|
| `title` | string | ✓ | Post title | "CSS container queries" |
| `summary` | string | | Short summary for listings | "Learn how container queries work" |
| `metadesc` | string | | SEO meta description | "A complete guide to..." |
| `date` | date | ✓ | Publication date | `2026-01-15` |
| `lastmod` | date | ✓ | Last modified date | `2026-01-15` |
| `id` | number | ✓ | Unique post ID | `1234` |
| `status` | enum | | draft/open/closed | `draft` (default) |
| `categories` | list | ✓ | Category tags | `[Design, Code]` |
| `tags` | list | | Free-form tags | `[css, responsive]` |
| `theme` | string | | Color theme | `indigo`, `blue`, `green` |
| `fileroot` | string | | Image filename base | `container-queries` |
| `medium` | string | | Medium image path | `/images/blog/...` |
| `large` | string | | Large image path | `/images/blog/...` |
| `ogImage` | string | | Open Graph image | `/images/blog/...-og.png` |
| `images` | list | | Additional images | Array of paths |
| `codepen` | boolean | | Include CodePen embed | `true` or `false` |
| `twitter` | boolean | | Show Twitter share | `true` or `false` |

#### Available Categories

Categories must match one of the predefined options:
- Design
- Code
- Opinion

(See `content/categories.js` for complete list)

#### Computed Fields (Auto-Generated)

These fields are automatically generated by Contentlayer:

- `slug`: Generated from filename, year prefix removed (`/blog/container-queries`)
- `slugAsParams`: Slug without `/blog` prefix (`container-queries`)
- `headings`: Table of contents extracted from markdown headings
- `readingTime`: Estimated reading time (words, minutes)
- `structuredData`: JSON-LD schema for SEO

**You don't need to add these fields manually** - they're computed automatically.

### Page (Static Pages)

File location: `content/pages/**/*.md`

#### Frontmatter Template

```yaml
---
title: About
description: Learn more about iamsteve.me
slot: ~
---

Your page content here...
```

#### Field Reference

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `title` | string | ✓ | Page title |
| `description` | string | | Page description |
| `slot` | mdx | | Additional MDX slot content |

#### Computed Fields

- `slug`: Generated as `/page-name`
- `slugAsParams`: Page name without leading slash

### Collections (Curated Links)

File location: `content/collections/**/*.md`

#### Frontmatter Template

```yaml
---
title: Container Query Resources
url: https://example.com/article
date: 2026-01-15
collection:
  - CSS
kind: article
---

Optional description or notes...
```

#### Field Reference

| Field | Type | Required | Description | Options |
|-------|------|----------|-------------|---------|
| `title` | string | ✓ | Link title | |
| `url` | string | ✓ | External URL | |
| `date` | date | ✓ | Added date | `2026-01-15` |
| `collection` | list | ✓ | Collection tags | See collections.js |
| `kind` | enum | | Link type | website/article/resource/tool |

## Creating New Blog Posts

### Step 1: Determine Post ID

Find the next available ID:
```bash
# IDs are typically sequential
# Check the highest ID in existing posts
```

### Step 2: Create File with Year Prefix

```bash
# Format: content/blog/YYYY-your-slug-here.md
content/blog/2026-css-container-queries.md
```

### Step 3: Add Complete Frontmatter

Use the complete template above, ensuring:
- ✓ All required fields present (title, date, lastmod, id, categories)
- ✓ Dates in YYYY-MM-DD format
- ✓ Categories match predefined list
- ✓ Tags are array format `[tag1, tag2]`
- ✓ Status set to `draft` for unpublished posts

### Step 4: Write MDX Content

```markdown
# Main Heading

Your intro paragraph with **bold** and *italic* text.

## Subheading

More content here...

### Code Example

​```tsx
export function Example() {
  return <div>Hello</div>;
}
​```

## Another Section

Continue your post...
```

### Step 5: Add Images (Optional)

If including images:
1. Save images to `public/images/blog/`
2. Use fileroot as base name: `container-queries.png`
3. Create variants:
   - `container-queries-medium.png` (listing thumbnail)
   - `container-queries-large.png` (hero image)
   - `container-queries-og.png` (social media preview)
4. Reference in frontmatter using `/images/blog/` prefix

## MDX Patterns

### Standard Markdown

```markdown
# Heading 1
## Heading 2
### Heading 3

**Bold text**
*Italic text*
`inline code`

[Link text](https://example.com)

- Bullet list
- Another item

1. Numbered list
2. Another item
```

### Code Blocks

```markdown
​```tsx
// TypeScript/React code
export function Component() {
  return <div>Hello</div>;
}
​```

​```css
/* CSS code */
.container {
  display: grid;
}
​```
```

### Images

```markdown
![Alt text](/images/blog/example.png)
```

### Callouts (if implemented)

```markdown
> **Note**: This is an important callout
```

## Querying Content

### In Server Components

```tsx
import { allPosts } from 'contentlayer/generated';

// Get all published posts
const posts = allPosts
  .filter(post => post.status === 'open')
  .sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime());

// Get single post by slug
const post = allPosts.find(post => post.slugAsParams === params.slug);

// Get posts by category
const designPosts = allPosts.filter(post =>
  post.categories?.includes('Design')
);

// Get posts by tag
const cssPostswith = allPosts.filter(post =>
  post.tags?.includes('css')
);
```

### Using Computed Fields

```tsx
// Reading time
<span>{post.readingTime.text}</span>
// Output: "5 min read"

// Table of contents
{post.headings.map(heading => (
  <a href={`#${heading.slug}`}>{heading.text}</a>
))}

// Structured data for SEO
<script
  type="application/ld+json"
  dangerouslySetInnerHTML={{ __html: JSON.stringify(post.structuredData) }}
/>
```

## Best Practices

### Frontmatter Conventions

1. **Always include required fields**: title, date, lastmod, id, categories
2. **Set status appropriately**:
   - `draft`: Work in progress, not published
   - `open`: Published and accepting comments
   - `closed`: Published, comments closed
3. **Keep summary concise**: 1-2 sentences max
4. **Write SEO-friendly metadesc**: Under 160 characters, include target keywords
5. **Use consistent categories**: Stick to predefined list
6. **Tag thoughtfully**: 3-5 relevant tags per post

### File Naming

1. **Include year prefix**: `2026-slug-here.md`
2. **Use kebab-case**: lowercase with hyphens
3. **Keep slugs short**: 3-5 words max
4. **Be descriptive**: Slug should indicate topic

**Good filenames:**
- `2026-css-container-queries.md`
- `2026-nextjs-app-router-guide.md`
- `2026-accessible-modals.md`

**Bad filenames:**
- `container-queries.md` (missing year)
- `CSS_Container_Queries.md` (wrong case)
- `my-post.md` (not descriptive)

### Content Organization

1. **Use semantic headings**: H2 for main sections, H3 for subsections
2. **Include code examples**: Show, don't just tell
3. **Add alt text to images**: Describe what's shown
4. **Link to related posts**: Cross-link relevant content
5. **Preview before publishing**: Check rendering in dev mode

### Image Optimization

1. **Optimize images**: Compress before uploading
2. **Use appropriate sizes**:
   - Medium: 800x450px (thumbnail)
   - Large: 1600x900px (hero)
   - OG: 1200x630px (social media)
3. **Use descriptive filenames**: Match content (`container-queries.png`)
4. **Provide alt text**: Describe image content

## Common Patterns

### New Blog Post (Minimal)

```yaml
---
title: Getting started with CSS container queries
summary: Learn the basics of container queries
date: 2026-01-15
lastmod: 2026-01-15
id: 1234
status: draft
categories:
  - Design
tags:
  - css
---

# Getting started with CSS container queries

Container queries allow elements to respond to their container's size...
```

### New Blog Post (With Images)

```yaml
---
title: Building accessible modals
summary: A complete guide to accessible modal dialogs
metadesc: Learn how to build WCAG 2.1 AA compliant modal dialogs with focus management and keyboard navigation
date: 2026-01-15
lastmod: 2026-01-15
id: 1235
status: draft
categories:
  - Code
tags:
  - accessibility
  - javascript
  - react
theme: blue
fileroot: accessible-modals
medium: /images/blog/accessible-modals-medium.png
large: /images/blog/accessible-modals-large.png
ogImage: /images/blog/accessible-modals-og.png
---

# Building accessible modals

Modal dialogs are a common UI pattern...
```

### Updating Existing Post

When updating a post:
1. Update the content
2. Update `lastmod` to current date
3. Keep original `date` unchanged
4. Consider adding update note at top if significant changes

```markdown
---
title: Existing Post Title
date: 2025-06-15
lastmod: 2026-01-15
---

> **Updated January 2026**: Added section on container query units

# Original content...
```

## Troubleshooting

### Post Not Appearing

Check:
1. File in correct location (`content/blog/`)
2. File has year prefix (`2026-slug.md`)
3. Frontmatter is valid YAML
4. All required fields present
5. Status is not `draft` (if filtering published posts)
6. Contentlayer build succeeded (`pnpm cl`)

### Computed Fields Missing

If slug, readingTime, or headings are undefined:
1. Rebuild Contentlayer: `pnpm cl`
2. Restart dev server: `pnpm dev`
3. Check for syntax errors in MDX content

### Categories Not Validating

Categories must match predefined list in `content/categories.js`:
1. Check exact spelling
2. Check exact casing
3. Ensure it's in array format: `[Category]`

## Integration with Other Skills

- **Writing Style Skill**: Apply British English, curly quotes, proper dashes in content
- **Next.js/Tailwind Skill**: Use server components to query and display content
- **Accessibility Skill**: Ensure content is accessible (headings, alt text, semantic HTML)

## Quick Reference

### Minimal Required Frontmatter

```yaml
---
title: Post Title
date: 2026-01-15
lastmod: 2026-01-15
id: 1234
categories:
  - Design
---
```

### Full Featured Frontmatter

```yaml
---
title: Post Title
summary: Brief summary
metadesc: SEO description
date: 2026-01-15
lastmod: 2026-01-15
id: 1234
status: draft
categories:
  - Design
  - Code
tags:
  - css
  - javascript
theme: blue
fileroot: post-slug
medium: /images/blog/post-slug-medium.png
large: /images/blog/post-slug-large.png
ogImage: /images/blog/post-slug-og.png
---
```

### Content Query Examples

```tsx
// All published posts, newest first
const posts = allPosts
  .filter(p => p.status === 'open')
  .sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime());

// Posts by category
const designPosts = allPosts.filter(p => p.categories?.includes('Design'));

// Posts by tag
const cssPosts = allPosts.filter(p => p.tags?.includes('css'));

// Single post
const post = allPosts.find(p => p.slugAsParams === slug);

// Recent posts (5 latest)
const recentPosts = allPosts
  .sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime())
  .slice(0, 5);
```

## Development Commands

```bash
# Build Contentlayer
pnpm cl

# Dev mode (with Contentlayer watch)
pnpm dev

# Full build (Contentlayer + lint + Next.js)
pnpm build

# Create new post (if script exists)
pnpm post
```
